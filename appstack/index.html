<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Appstack Images - DockerDemos</title>
  

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="../css/highlight.css">

  <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/modernizr/2.8.3/modernizr.min.js"></script>
  <script type="text/javascript" src="../js/highlight.pack.js"></script>
  <script src="../js/theme.js"></script>

  <style>
    body {font-size: 90%;}
    pre, code {font-size: 100%;}
    h3, h4, h5, h6 {color: #2980b9; font-weight: 300}
  </style> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href=".." class="icon icon-home"> DockerDemos</a>
        
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
      <ul class="current">
    
        
        <span>Appstack</span>
            
                <li class="toctree-l1 current">
                    <a class="current" href=".">Appstack Images</a>
                    
                        <ul>
                        
                            <li class="toctree-l2"><a href="#appstack-image-reference">Appstack Image Reference</a></li>
                            
                                <li><a class="toctree-l3" href="#appstack-image-summary">Appstack Image Summary</a></li>
                            
                                <li><a class="toctree-l3" href="#appstack-data">Appstack-Data</a></li>
                            
                                <li><a class="toctree-l3" href="#appstack-setup-mysql">Appstack-Setup-MySQL</a></li>
                            
                                <li><a class="toctree-l3" href="#appstack-mysql">Appstack-MySQL</a></li>
                            
                                <li><a class="toctree-l3" href="#appstack-apache">Appstack-Apache</a></li>
                            
                                <li><a class="toctree-l3" href="#appstack-drush">Appstack-Drush</a></li>
                            
                                <li><a class="toctree-l3" href="#appstack-backup">Appstack-Backup</a></li>
                            
                                <li><a class="toctree-l3" href="#appstack-setup-drupal">Appstack-Setup-Drupal</a></li>
                            
                        
                        </ul>
                    
                </li>
            
        

    
        
            <li class="toctree-l1 ">
                <a class="" href="../http-master">http-master</a>
            </li>
        

    
        
        <span>For Fun</span>
            
                <li class="toctree-l1 ">
                    <a class="" href="../dwarffortressserver">Dwarf Fortress Server</a>
                    
                </li>
            
                <li class="toctree-l1 ">
                    <a class="" href="../minecraftserver">Minecraft Server</a>
                    
                </li>
            
                <li class="toctree-l1 ">
                    <a class="" href="../fullscreenmario">Fullscreen Mario</a>
                    
                </li>
            
        

    
</ul>

      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="icon icon-reorder"></i>
        <a href=".."></a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="..">Docs</a> &raquo;</li>
    <li>Appstack Images</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="https://github.com/DockerDemos/" class="icon icon-github"> Edit on GitHub</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              <h1 id="appstack-image-reference">Appstack Image Reference</h1>
<p>The DockerDemos Appstack projects are a collection of Docker images that can run containers in various linked configurations to build a variety of application stacks.</p>
<p>For example, a basic WordPress service consists of -</p>
<ol>
<li>Storage</li>
<li>A database server</li>
<li>A web server</li>
<li>A PHP processor</li>
<li>The WordPress code</li>
</ol>
<p>With Appstack images, you can build an entire WordPress service from zero to fully installed and ready to accept content, all inside Docker containers.  With a <a href="https://gist.github.com/clcollins/cfab1f63dc1aa927bf9f">handy script</a>, it can be done in seconds!</p>
<p>Depending on the images used, you could have a full WordPress instance, or a Drupal site, or a basic LAMP stack, or in the near future, Ruby on Rails, Django, etc..  It just depends only on the chosen images and how they are linked.</p>
<h2 id="appstack-image-summary">Appstack Image Summary</h2>
<ul>
<li><a href="#appstack-data">appstack-data</a>: A data-only container image- the heart that ties all the Appstack containers together</li>
<li><a href="#appstack-setup-mysql">appstack-setup-mysql</a>: A MariaDB pre-configuration container image that runs once to initialize a MariaDB server.</li>
<li><a href="#appstack-mysql">appstack-mysql</a>: A MariaDB container image for running your database server.</li>
<li><a href="#appstack-phpfpm">appstack-phpfpm</a>: A PHP FastCGI Process Manager container image</li>
<li><a href="#appstack-apache">appstack-apache</a>: An Apache web server container image; designed to offload PHP processing to the appstack-phpfpm containers.</li>
<li><a href="#appstack-wpcli">appstack-wpcli</a>: A WP-CLI container image, for automating installation, upgrades and management of WordPress sites run in an Appstack container stack.</li>
<li><a href="#appstack-drush">appstack-drush</a>: A Drush container image, for automating installation, upgrades and management of Drupal sites run in an Appstack container stack.</li>
<li><a href="#appstack-setup-drupal">appstack-setup-drupal</a>: A Drupal container image for automating the install of a Drupal website  inside an Appstack container stack.</li>
<li><a href="#appstack-backup">appstack-backup</a>: An container image for automating MariaDB database backups.</li>
</ul>
<h2 id="appstack-data">Appstack-Data</h2>
<p><a name="appstack-data"></a></p>
<p>The Appstack-data image is the heart of any group of linked Appstack images.  It allows you to share storage volumes among the linked containers easily, and to mount volumes from your host into the Appstack stack (eg. /var/lib/mysql, or /var/www/html - for persistence).</p>
<p><strong>Github Repo:</strong> <a href="https://github.com/DockerDemos/appstack-data">https://github.com/DockerDemos/appstack-data</a></p>
<p><strong>Issue Tracker:</strong> <a href="https://github.com/DockerDemos/appstack-data/issues">https://github.com/DockerDemos/appstack-data/issues</a></p>
<p>The Appstack-data image currently allows linked containers to share the following volumes:</p>
<ul>
<li>/var/www/html</li>
<li>/var/lib/mysql</li>
<li>/var/log</li>
<li>/var/backup</li>
<li>/conf</li>
<li>/root/.secret</li>
</ul>
<p>You can mount directories from your host server into these volumes by passing the <code>-v &lt;host directory&gt;:&lt;data container volume&gt;</code> argument when starting the data container.  In addition, volumes can be shared by passing the <code>--volumes-from &lt;data container name&gt;</code> argument to any linked containers when they are started.</p>
<p>Example of mounting host volumes inside the data container:</p>
<pre><code>docker run --name data -v /srv/html:/var/www/html -v /srv/mysql:/var/lib/mysql -v /srv/log:/var/log -v /srv/backup:/var/backup -v /srv/conf:/conf -it appstack-data
</code></pre>
<h2 id="appstack-setup-mysql">Appstack-Setup-MySQL</h2>
<p><a name="appstack-setup-mysql"></a></p>
<p>The Appstack-Setup-MySQL image is a single-use configuration image used to initialize a MariaDB database before an Appstack-MySQL container is run.  This image is designed to run only once per stack, and should be run after the Data container has started, and before the MySQL container is started.</p>
<p><strong>Github Repo:</strong> <a href="https://github.com/DockerDemos/appstack-setup-mysql">https://github.com/DockerDemos/appstack-setup-mysql</a></p>
<p><strong>Issue Tracker:</strong> <a href="https://github.com/DockerDemos/appstack-setup-mysql/issues">https://github.com/DockerDemos/appstack-setup-mysql/issues</a></p>
<p>The Appstack-Setup-MySQL image requires only the <code>--volumes-from &lt;data container name&gt;</code> argument to be passed when run.  It does not need anything else to function.</p>
<p>When run, it will run the <code>mysql_install_db</code> command to initialize the MariaDB database.  It will set the root password, create a backup user and password, and create a randomly-named database.  It will then store this information in <code>/root/.secret/dbdata.yaml</code> in the data container.  The <code>dbdata.yaml</code> file is used by other appstack containers to setup applications requiring a database.</p>
<p>Example:</p>
<pre><code>docker run --volumes-from data -it appstack-setup-mysql
</code></pre>
<p>...where "data" is the name chosen for the data container.</p>
<h2 id="appstack-mysql">Appstack-MySQL</h2>
<p><a name="appstack-mysql"></a></p>
<p>The Appstack-MySQL images is a simple MariaDB database server inside a Docker container.  It requires only that the Appstack-Setup-MySQL container is run before starting for the first time.  After that, the Appstack-MySQL image can start the database container again in the future without the extra initializations step.
<strong>Github Repo:</strong> <a href="https://github.com/DockerDemos/appstack-mysql">https://github.com/DockerDemos/appstack-mysql</a></p>
<p><strong>Issue Tracker:</strong> <a href="https://github.com/DockerDemos/appstack-mysql/issues">https://github.com/DockerDemos/appstack-mysql/issues</a></p>
<p>Example:</p>
<pre><code>docker run --volumes-from data --name db -d appstack-mysql
</code></pre>
<p>...where "data" is the name chosen for the data container, and "db" is the name to be assigned to the database container.</p>
<h2 id="appstack-phpfpm"><a name="appstack-phpfpm">Appstack-PHPFPM</a></h2>
<p>The Appstack-PHPFPM image runs a PHP-FPM server and is used for any application stacks that require PHP processing (Basic LAMP, WordPress, etc).</p>
<p><strong>Github Repo:</strong> <a href="https://github.com/DockerDemos/appstack-phpfpm">https://github.com/DockerDemos/appstack-phpfpm</a></p>
<p><strong>Issue Tracker:</strong> <a href="https://github.com/DockerDemos/appstack-phpfpm/issues">https://github.com/DockerDemos/appstack-phpfpm/issues</a></p>
<p>The Appstack-PHPFPM image needs a few things to be useful:</p>
<ul>
<li>The code you wish to run mounted in /var/www/html (usually with <code>--volumes-from</code> a data container)</li>
<li>Linked to the database container with the alias <code>db</code></li>
<li>Optionally, an environment variable for <code>SMTPSERVER</code>, to enable email support</li>
<li>Optionally, an environment variable for <code>DOMAIN</code>.</li>
</ul>
<p>Specifying an SMTP server in the <code>SMTPSERVER</code> environment variable will enable outgoing email support for PHP (using SSMTP for sendmail).  If you do not supply a <code>DOMAIN</code> environment variable, the container will try to parse the third-level domain from <code>SMTPSERVER</code>.</p>
<p>Example:</p>
<pre><code>docker run --volumes-from data --name fpm --link db:db  -d appstack-phpfpm
</code></pre>
<p>...where "data" is the name chosen for the data container,"db" is the name assigned to the database container, and "fpm" is the name to be assigned to the database container.</p>
<h2 id="appstack-apache">Appstack-Apache</h2>
<p><a name="appstack-apache"></a></p>
<p>The Appstack-Apache image is a front end for PHP-FPM.  Mod_FASTCGI is built into the image, and it's pre-configured to connect to a PHP-FPM container.  Currently, this is the only working Apache image, but other images are in development now for Python WSGI, Ruby on Rails and, as an alternative to Apache, Nginx.</p>
<p><strong>Github Repo:</strong> <a href="https://github.com/DockerDemos/appstack-apache">https://github.com/DockerDemos/appstack-apache</a></p>
<p><strong>Issue Tracker:</strong> <a href="https://github.com/DockerDemos/appstack-apache/issues">https://github.com/DockerDemos/appstack-apache/issues</a></p>
<p>The Appstack-Apache images is currently the most complicated to run.  It requires several things:</p>
<ul>
<li>A <code>/conf</code> directory that includes an SSL key and certificates (<strong>REQUIRED</strong>, but may be self-signed).</li>
<li>The SSL key and cert named <code>localhost.key</code> and <code>localhost.crt</code>, respectively</li>
<li>An optional <code>ca-cert.crt</code> that includes your certificate authority's intermediate cert bundle.</li>
<li>The files to be served in /var/www/html</li>
<li>Port 80 and port 443 mapped to ports on your host</li>
<li>An <code>SITENAME</code> environment variable with the domain for your website.</li>
</ul>
<p>Both <code>/conf</code> and <code>/var/www/html</code> are most easily provided to the Appstack-Apache container by mapping <code>--volumes-from</code> a data container.</p>
<p>Example:</p>
<pre><code>docker run --volumes-from data --link fpm:fpm --name web -p 80:80 -p 443:443 -e 'SITENAME=your.site.name' -d appstack-apache
</code></pre>
<h2 id="appstack-wpcli"><a name="appstack-wpcli">Appstack-WPCLI</a></h2>
<p>The Appstack-WPCLI image is designed to accept all the regular <a href="http://wp-cli.org/commands">WP-CLI commands</a>, as well as run a few helper scripts to assist in automating WordPress managemtn with other Appstack containers.</p>
<p><strong>Github Repo:</strong> <a href="https://github.com/DockerDemos/appstack-wpcli">https://github.com/DockerDemos/appstack-wpcli</a></p>
<p><strong>Issue Tracker:</strong> <a href="https://github.com/DockerDemos/appstack-wpcli/issues">https://github.com/DockerDemos/appstack-wpcli/issues</a></p>
<p><strong>Examples</strong></p>
<p><em>Download WordPress from WordPress.org:</em></p>
<pre><code>docker run --volumes-from data -w /var/www/html -it appstack-wpcli /scripts/core-download.sh
</code></pre>
<p><em>Setup the wp-config.php file:</em></p>
<pre><code>docker run --volumes-from data -w /var/www/html -it appstack-wpcli /scripts/core-config.sh
</code></pre>
<p>This reads the DB config information from dbdata.yaml, setup by the appstack-setup-mysql container.</p>
<p><em>Finalize the WP install:</em></p>
<pre><code>docker run --link db:db --volumes-from data -w /var/www/html -e SITENAME="https://${SITENAME}" -e TITLE=hastur -e ADMIN=joebob -e ADMINPASS=foobarbaz -e ADMINEMAIL=joe.bob@example.org -it appstack-wpcli /scripts/core-install.sh
</code></pre>
<p><em>Example Plugin install:</em></p>
<pre><code>docker run --link db:db --volumes-from data -w /var/www/html -it appstack-wpcli wp plugin install shibboleth --activate
</code></pre>
<p>This installs and activates the "Shibboleth" plugin from WordPress.org.  However, it doesn't configure the plugin, just turns it on.  That leads to the next useful command...</p>
<p><em>Arbitrary SQL Queries:</em></p>
<pre><code>docker run --link db:db --volumes-from data -w /var/www/html -it appstack-wpcli wp db query "select * from wp_options where option_id=1 \G"
</code></pre>
<p>This lets you run a query (including UPDATE) on the WP database using the info in the wp-config.php file. This way you could potentially pre-configure any specific plugin settings that aren't setup by default - such as the Shibboleth stuff, for instance.</p>
<h2 id="appstack-drush">Appstack-Drush</h2>
<p><a name="appstack-drush"></a></p>
<p><a href="https://github.com/DockerDemos/appstack-drush">https://github.com/DockerDemos/appstack-drush</a></p>
<h2 id="appstack-backup">Appstack-Backup</h2>
<p><a name="appstack-backup"></a></p>
<p><a href="https://github.com/DockerDemos/appstack-backup">https://github.com/DockerDemos/appstack-backup</a></p>
<h2 id="appstack-setup-drupal">Appstack-Setup-Drupal</h2>
<p><a name="appstack-setup-drupal"></a></p>
<p><strong>Appstack-Setup-Drupal is deprecated in favor of appstack-drush, and will no longer be maintained.</strong></p>
<p><a href="https://github.com/DockerDemos/appstack-setup-drupal">https://github.com/DockerDemos/appstack-setup-drupal</a></p>

            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../http-master" class="btn btn-neutral float-right" title="http-master"/>Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href=".." class="btn btn-neutral" title="DockerDemos"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
    <!-- Copyright etc -->
    </p>
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
	  
        </div>
      </div>

    </section>

  </div>

<div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
        
            <a class="icon icon-github" style="float: left; color: #fcfcfc"> GitHub</a>
        
      <span><a href=".." style="color: #fcfcfc;">&laquo; Previous</a></span>
      <span style="margin-left: 15px"><a href="../http-master" style="color: #fcfcfc">Next &raquo;</a></span>
    </span>
</div>
</body>
</html>